{% extends "home.html" %}

{% block banner %}
<div class="container">
  <div class="row">
    <div class="col px-0">
      <div class="jumbotron jumbotron-guild text-white">
        <div class="jumbotron-overlay"></div>
        <div class="position-absolute w-100 p-3" style="bottom: 0;">
          <div class="d-md-flex text-center text-md-left">
            <div>
              <img src="" class="guild-icon-square-lg">
            </div>
            <div class="ml-3 w-100">
              <h1 class="h3 d-inline-block mr-2">+{{ b.name }}
               {% if b.over_18 %}
               <span class="badge badge-danger">NSFW</span>
               {% endif %}
             </h1>
             <div><span class="text-small"><span class="font-weight-bold">{{ b.subscriber_count }}</span> member{{ 's' if b.subscriber_count != 1 else '' }}<span> Â· </span>
             <span class="font-weight-bold">{{ b.age_string }}</span> est.</span>
              </div>
             <div class="mt-1">{{ b.description_html | safe }}</div>
             <div class="d-flex">
             <div class="w-100">
             {% for mod in b.mods %}
             <a href="{{ mod.permalink }}"><div class="profile-pic-35 border-3 border-white rounded-circle d-inline-block" style="background-color:#{{ mod.color }}"><span class="letter text-white">{{ mod.username[0] }}</span></div></a>
             {% else %}
             No guildmasters
             {% endfor %}
             </div>
             {% if v %}
             <div id="button-sub" {% if is_subscribed %}class="d-none"{% endif %}><a class="btn btn-primary btn-block" href="javascript:void(0)" onclick="post('/api/subscribe/{{ b.name }}', callback=function(){document.getElementById('button-unsub').classList.toggle('d-none');document.getElementById('button-sub').classList.toggle('d-none');})">Join +{{ b.name }}</a></div>
             <div id="button-unsub" {% if not is_subscribed %}class="d-none"{% endif %}><a class="btn btn-secondary btn-block" href="javascript:void(0)" onclick="post('/api/unsubscribe/{{ b.name }}', callback=function(){document.getElementById('button-unsub').classList.toggle('d-none');document.getElementById('button-sub').classList.toggle('d-none');})">Leave +{{ b.name }}</a></div>
             {% endif %}
             </div>
           </div>
         </div>
       </div>
     </div>
   </div>
 </div>
</div>
{% endblock %}

{% block adminpanel %}
{% endblock %}

{% block sidebarblock %}
<div class="sidebar-section sidebar-info-basic">
  <div class="body pb-0">
   {% if b.fa_icon %}
   <div class="body text-primary text-center"><i class="{{ b.fa_icon }}" style="font-size:4rem"></i></div>
   {% endif %}
   <h1 class="h6 d-inline-block">+{{ b.name }}</h1>
   <div><span data-toggle="tooltip" data-placement="bottom" title="" data-original-title="{{ b.created_date }}" class="text-muted"><i class="fad fa-calendar-day fa-width-rem text-muted"></i> Founded {{ b.age_string }}</span></div>
   <div><span class="text-muted"><i class="fad fa-users fa-width-rem"></i> {{ b.subscriber_count }} Member{{ 's' if b.subscriber_count != 1 else '' }}</span></div>
 </div>
 {% if b.over_18 %}
 <div class="body">
  <span class="badge badge-danger">NSFW</span>
</div>
{% endif %}
<div class="body pt-0">
  {{ b.description_html | safe }}
</div>
</div>
<div class="sidebar-section sidebar-submit">
  <div class="title">Submit to +{{ b.name }}</div>
  <div class="body">
    <a class="btn btn-primary btn-block" href="/submit?guild={{ b.name | urlencode }}">Create Post in +{{ b.name }}</a>
  </div>
</div>
<div class="sidebar-section sidebar-mods">
  <div class="title">Guildmasters</div>
  <div class="body">
    <ul>
      {% for mod in b.mods %}
      <li><a href="{{ mod.permalink }}">@{{ mod.username }}</a></li>
      {% else %}
      <li>None</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% if v and b.has_mod(v) %}
<div class="sidebar-section sidebar-guild-tools">
  <div class="title">Guildmaster Tools</div>
  <div class="body pt-0">
    <div><a href="{{ b.permalink}}/mod/settings"><i class="fad fa-cog fa-width-rem"></i>Settings</a></div>
    <div><a href="{{ b.permalink}}/mod/mods"><i class="fad fa-user-crown fa-width-rem"></i>Guildmasters</a></div>
    <div><a href="{{ b.permalink}}/mod/exiled"><i class="fad fa-gavel fa-width-rem"></i>Exiles</a></div>
  </div>
</div>
{% endif %}
{% endblock %}

{% block sidebarLeftblock %}

{% if not v %}
<div class="sidebar-section sidebar-alert">
  <div class="body">
    {% if b.fa_icon %}
    <i class="{{ b.fa_icon }} text-primary mb-3" style="font-size: 3rem;"></i>
    {% endif %}
    <h4>Jump into the discourse of <span class="text-primary">+{{ b.name }}</span></h4>
    <p class="text-small">A Ruqqus account lets you be a part of your favorite communities.</p>
    <a href="/signup" class="btn btn-primary btn-block">Sign up</a>
  </div>
</div>
{% endif %}

{% if v %}

<div class="sidebar-section sidebar-dashboard">
  <div class="title">Dashboard</div>
  <div class="body">
    <ul class="no-bullets dashboard-list pl-0">
      <li class="dashboard-item">
        <a class="dashboard-link" href="/"><i class="fas fa-home-alt fa-width-rem"></i>Home</a>
      </li>
      <li class="dashboard-item">
       <a class="dashboard-link" href="/guilds"><i class="fas fa-university fa-width-rem"></i>Guilds</a>
     </li>
     <li class="dashboard-item">
       <a class="dashboard-link" href="/subscriptions"><i class="fas fa-heart fa-width-rem"></i>Subscriptions</a>
     </li>
     <li class="dashboard-item">
      <a class="dashboard-link" href="/browse"><i class="fas fa-binoculars fa-width-rem"></i>Browse</a>
    </li>
  </ul>
</div>
</div>

{% endif %}

{% if trending_boards %}
<div class="sidebar-section sidebar-guild-recommendations sticky-63">
  <div class="title">Rising Guilds</div>
  <div class="body">
    <ul class="no-bullets guild-recommendations-list pl-0">
     {% for entry in trending_boards[0:5] %}
     <li class="guild-recommendations-item">
      <a href="{{ entry[0].permalink }}">
      <div class="d-flex">
      <div class="mr-2">
          <img src="" class="guild-icon-square-35"></div>
          <div>
            <div class="text-black font-weight-normal">+{{ entry[0].name }}</div>
            <div class="text-muted text-small font-weight-normal">{{ entry[1] }} Member{{ '' if entry[1]==1 else 's' }}</div>
          </div>
      </div>
      </a>
    </li>
    {% endfor %}
  </ul>
</div>
</div>
{% endif %}

{% endblock %}

{% block pagetype %}userpage{% endblock %}

{% block title %}
<title>Ruqqus: +{{ b.name }}</title>
<meta name="description" content="+{{ b.name }}">
{% endblock %}

{% block enlargeThumbJS %}
<script src="/assets/js/enlarge_thumb.js"></script>
{% endblock %}

{% block fixedMobileBarJS %}
<script>
  var prevScrollpos = window.pageYOffset;
  window.onscroll = function () {
    var currentScrollPos = window.pageYOffset;
    if (prevScrollpos > currentScrollPos) {
      document.getElementById("fixed-bar-mobile").style.top = "49px";
      document.getElementById("navbar").classList.remove("shadow");
    } 
    else if (currentScrollPos <= 125) {
      document.getElementById("fixed-bar-mobile").style.top = "49px";
      document.getElementById("navbar").classList.remove("shadow");
    }
    else {
      document.getElementById("fixed-bar-mobile").style.top = "-49px";
      document.getElementById("dropdownMenuSortBy").classList.remove('show');
      document.getElementById("dropdownMenuFrom").classList.remove('show');
      document.getElementById("navbar").classList.add("shadow");
    }
    prevScrollpos = currentScrollPos;
  }
</script>
{% endblock %}