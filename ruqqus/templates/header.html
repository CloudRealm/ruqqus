<!-- Navigation -->
<nav class="navbar navbar-expand-md navbar-light bg-white shadow shadow-md fixed-top" id="navbar">
  <div class="container">
    <div class="flex-grow-1"><a href="/" class="navbar-brand">ruqqus</a></div>
    <div class="flex-grow-1 d-fl d-none d-md-block">
      <form class="form-inline search flex-nowrap mx-0 mx-lg-auto" action="/search" method="get">
        <input class="form-control w-100" type="search" placeholder="Search" aria-label="Search" name="q">
        <span class="input-group-append">
          <span class="input-group-text border-0 bg-transparent" style="margin-left: -2.5rem;">
            <i class="fa fa-search" aria-hidden="true"></i>
          </span>
        </span>
      </form>
    </div>
    {% if v %}
    <a class="mobile-nav-icon d-block d-md-none" href="/submit{{ '?guild='+b.name if b else '' }}"><i class="fas fa-feather-alt align-middle text-gray-500"></i></a>
    {% else %}
    <a class="mobile-nav-icon d-block d-md-none" href="/login"><i class="fas fa-feather-alt align-middle text-gray-500"></i></a>
    {% endif %}
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
    aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon {% if v and v.notifications_count %}position-relative{% endif %}"><i class="fal fa-bars text-gray-500"></i>
      {% if v and v.notifications_count %}
      <i class="fas fa-circle text-danger text-small-extra position-absolute" style="right: -6px; top: -4px;"></i>
      {% endif %}
    </span>
  </button>
  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav ml-auto d-none d-md-flex">

      {% if v %}
      <li class="nav-item d-flex align-items-center justify-content-center text-center mx-1" data-toggle="modal" data-target="#announcementsModalScrollable" >
        <div class="nav-link" role="button" data-toggle="tooltip" data-placement="bottom" data-delay='{"show":"700", "hide":"0"}' title="Announcements"><i class="fas fa-sparkles text-purple"></i></div>
      </li>
      {% endif %}

      {% if v and v.mods_anything %}
      <li class="nav-item d-flex align-items-center justify-content-center text-center mx-1">
        <a class="nav-link" href="{{ '/+'+b.name if b and b.has_mod(v) else '' }}/mod/queue" data-toggle="tooltip" data-placement="bottom" data-delay='{"show":"700", "hide":"0"}' title="Guildmaster tools"><i class="fas fa-crown{% if v.has_report_queue %} text-success{% endif %}"></i></a>
      </li>
      {% endif %}

      {% if v %}
      <li class="nav-item d-flex align-items-center justify-content-center text-center mx-1">
        <a class="nav-link" href="/submit{{ '?guild='+b.name if b else '' }}" data-toggle="tooltip" data-placement="bottom" data-delay='{"show":"700", "hide":"0"}' title="Create post"><i class="fas fa-feather-alt"></i></a>
      </li>

      {% if v.notifications_count %}

      <li class="nav-item d-flex align-items-center text-center justify-content-center mx-1">
        <a class="nav-link position-relative" href="/notifications" data-toggle="tooltip" data-placement="bottom" title="Notifications"><i class="fas fa-bell" data-toggle="tooltip" data-placement="bottom" data-delay='{"show":"700", "hide":"0"}' title="{{ v.notifications_count }} notifications"></i><span class="badge-count">{{ v.notifications_count }}</span></a>
      </li>

      {% elif v.notifications_count > 9 %}

      <li class="nav-item d-flex align-items-center text-center justify-content-center mx-1">
        <a class="nav-link position-relative" href="/notifications" data-toggle="tooltip" data-placement="bottom" title="Notifications"><i class="fas fa-bell" data-toggle="tooltip" data-placement="bottom" data-delay='{"show":"700", "hide":"0"}' title="9+ notifications"></i><span class="badge-count" style="width: 26px;">9+</span></a>
      </li>

      {% else %}

      <li class="nav-item d-flex align-items-center text-center justify-content-center mx-1">
        <a class="nav-link" href="/notifications?all=true" data-toggle="tooltip" data-placement="bottom" data-delay='{"show":"700", "hide":"0"}' title="Notifications"><i class="fas fa-bell"></i></a>
      </li>

      {% endif %}

      <li class="nav-item d-flex align-items-center justify-content-center text-center">
        <div class="dropdown">
          <a class="nav-link bg-transparent py-0 pr-0" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          <div class="d-flex">
            <div><img src="{{ v.profile_url }}" class="profile-pic-35"></div>
            <div class="my-auto text-left pl-2">
              <div class="text-small font-weight-bold">{{ v.username }}</div>
              <div class="text-small-extra text-purple"><i class="fad fa-dice-d10 mr-1"></i>{{ v.energy }} Rep</div>
            </div>
          </div>
        </a>
        <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-left border-0 shadow fade px-0 mt-2"
        aria-labelledby="dropdownMenuButton">
        <div class="px-2">
          <div class="dropdown-meta">
            <div class="font-weight-bold mb-2">{{ v.username }}</div>
            <div class="text-small text-purple"><i class="fad fa-dice-d10 mr-1"></i>{{ v.energy }} Rep</div>
          </div>
        </div>
        <hr class="my-2">
        <div class="px-2">
          <a class="dropdown-item" href="{{ v.permalink }}"><i class="fas fa-user-circle fa-width-rem text-left mr-3"></i>My
            profile</a>
            {% if v.notifications_count %}
            <a class="dropdown-item" href="/notifications"><i class="fas fa-inbox fa-width-rem text-left mr-3"></i>Inbox<span
              class="badge badge-danger rounded-circle align-top ml-1">{{ v.notifications_count }}</span></a>
              {% else %}
              <a class="dropdown-item" href="/notifications?all=true"><i class="fas fa-inbox fa-width-rem text-left mr-3"></i>Inbox</a>
              {% endif %}
              <a class="dropdown-item" href="/settings"><i class="fas fa-cog fa-width-rem text-left mr-3"></i>Settings</a>

              {% block darkswitch %}
              {% if v and v.referral_count and session.get("dark_mode_enabled")%}
              <a class="dropdown-item" href="javascript:void(0)" onclick="switch_css()"><i class="fad fa-toggle-on fa-width-rem text-left mr-3" id="dark-switch"></i>Dark mode</a>
              {% elif v and v.referral_count %}
              <a class="dropdown-item" href="javascript:void(0)" onclick="switch_css()"><i class="fad fa-toggle-off fa-width-rem text-left mr-3" id="dark-switch"></i>Dark mode</a>
              {% else %}
              <a class="dropdown-item" href="/settings/profile#referral"><i class="fad fa-toggle-off fa-width-rem text-left mr-3"></i>Dark mode</a>
              {% endif %}
              {% endblock %}
            </div>
            <hr class="my-2">
            <div class="px-2">
              <a class="dropdown-item" href="javascript:void(0)", onclick="post('/logout', callback=function(){window.location.reload(true)})">Log out</a>
            </div>
          </div>
        </div>
      </li>
      {% else %}
      <li class="nav-item d-flex align-items-center justify-content-center mx-1">
       <a class="btn btn-outline-purple" href="/login?redirect={{ request.path | urlencode}}">Sign In</a>
     </li>
     <li class="nav-item d-flex align-items-center justify-content-center mx-1">
       <a class="btn btn-purple" href="/signup?redirect={{ request.path | urlencode}}">Sign Up</a>
     </li>
     {% endif %}
   </ul>

   <!-- Mobile Nav Menu -->
   <ul class="navbar-nav ml-auto d-flex d-md-none mt-3">
     <li class="nav-item pb-3">
      <form class="form-inline search flex-nowrap mx-0 mx-lg-auto" action="/search" method="get">
        <input class="form-control form-control-sm w-100" type="search" placeholder="Search Ruqqus" aria-label="Search" name="q">
        <span class="input-group-append">
          <span class="input-group-text border-0 bg-transparent" style="margin-left: -2.5rem;">
            <i class="fa fa-search" aria-hidden="true"></i>
          </span>
        </span>
      </form>
    </li>
    <li class="nav-item">
      <a class="nav-link " href="/">
        <i class="fas fa-home-alt fa-width-rem mr-3"></i>Homepage
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link " href="/all?sort=new">
        <i class="fas fa-globe-americas fa-width-rem mr-3"></i>All
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link " href="/all?sort=hot">
        <i class="fas fa-fire fa-width-rem mr-3"></i>Trending
      </a>
    </li>
    {% if v %}
    <li class="nav-item border-top mt-2 pt-2">
      <a class="nav-link" href="{{ v.permalink }}"><i class="fas fa-user-circle fa-width-rem mr-3"></i>@{{ v.username }}</a>
    </li>
    <li class="nav-item">
      <a class="nav-link {% if v.notifications_count %}position-relative{% endif %}" href="/notifications?all=true">
        <i class="fas fa-envelope fa-width-rem mr-3"></i>Inbox
        {% if v.notifications_count %}
        <i class="fas fa-circle text-danger position-absolute" style="left: 18px; top: 8px; font-size: 10px;"></i>
        {% endif %}
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/mine"><i class="fas fa-university fa-width-rem mr-3"></i>My guilds</a>
    </li>
    {% if v and v.referral_count and session.get("dark_mode_enabled")%}
    <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="switch_css()"><i class="fad fa-toggle-on fa-width-rem mr-3" id="dark-switch"></i>Dark mode</a></li>
    {% elif v and v.referral_count %}
    <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="switch_css()"><i class="fad fa-toggle-off fa-width-rem mr-3" id="dark-switch"></i>Dark mode</a></li>
    {% else %}
    <li class="nav-item"><a class="nav-link" href="/settings/profile#referral"><i class="fad fa-toggle-off fa-width-rem mr-3"></i>Dark mode</a></li>
    {% endif %}
    <li class="nav-item border-top mt-2 pt-2">
      <a class="nav-link" href="/settings">Account settings</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="javascript:void(0)", onclick="post('/logout', callback=function(){window.location.reload(true)})">Log out</a>
    </li>
    <li class="nav-item border-top mt-2 pt-2">
      <a class="nav-link text-small-extra" href="/help/about">About</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="/help/conduct">Terms</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="/help/privacy">Privacy</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="mailto:hello@ruqqus.com">Contact</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="https://github.com/ruqqus/ruqqus">Github</a>
    </li>
    {% else %}
    <li class="nav-item d-flex align-items-center justify-content-center pb-3">
      <a class="btn btn-outline-purple btn-block" href="/login?redirect={{ request.path | urlencode}}">Sign in</a>
    </li>
    <li class="nav-item d-flex align-items-center justify-content-center">
      <a class="btn btn-purple btn-block" href="/signup?redirect={{ request.path | urlencode}}">Sign up</a>
    </li>
    <li class="nav-item mt-2">
      <a class="nav-link text-small-extra" href="/help/about">About</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="/help/conduct">Terms</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="/help/privacy">Privacy</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="mailto:hello@ruqqus.com">Contact</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-small-extra" href="https://github.com/ruqqus/ruqqus">Github</a>
    </li>
    {% endif %}
  </ul>

</div>
</div>
</nav>
